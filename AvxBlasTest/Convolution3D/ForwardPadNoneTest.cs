using AvxBlas;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using System;
using System.Linq;

namespace AvxBlasTest.Connection3DTest {
    [TestClass]
    public class ForwardPadNoneTest {
        [TestMethod]
        public void SForwardTest() {
            float max_err = 0;

            foreach (uint n in new int[] { 1, 2 }) {
                foreach ((uint iw, uint ih, uint id) in new (uint, uint, uint)[] {
                    (1, 1, 1), (1, 1, 4), (1, 4, 1), (4, 1, 1), (5, 2, 8), (12, 16, 15) }) {

                    foreach ((uint kw, uint kh, uint kd) in new (uint, uint, uint)[] {
                        (1, 1, 1), (1, 1, 3), (1, 3, 1), (3, 1, 1), (3, 3, 3), (3, 1, 5), (3, 5, 3), (5, 5, 5) }) {

                        if (iw < kw || ih < kh || id < kd) {
                            continue;
                        }
                        uint ow = iw - kw + 1, oh = ih - kh + 1, od = id - kd + 1;

                        foreach ((uint ic, uint oc) in new (uint, uint)[] { (1, 1), (2, 3), (3, 2), (4, 5), (5, 4), (8, 10), (10, 8),
                                                                            (7, 16), (16, 7), (9, 24), (24, 9), (31, 32), (32, 31), (43, 48), (48, 43), (15, 64), (64, 15) }) {

                            float[] xval = (new float[ic * iw * ih * id * n]).Select((_, idx) => (idx + 1) * 1e-3f).ToArray();
                            float[] wval = (new float[ic * oc * kw * kh * kd]).Select((_, idx) => (idx + 1) * 1e-3f).Reverse().ToArray();

                            Map3D x = new((int)ic, (int)iw, (int)ih, (int)id, (int)n, xval);
                            Filter3D w = new((int)ic, (int)kw, (int)kh, (int)kd, (int)oc, wval);

                            Map3D y = Reference(x, w, (int)kw, (int)kh, (int)kd);

                            Array<float> x_tensor = xval;
                            Array<float> w_tensor = wval;
                            Array<float> y_tensor = new(oc * ow * oh * od * n, zeroset: false);

                            Convolution3D.Forward(n, ic, oc, iw, ih, id, kw, kh, kd, PadMode.None, x_tensor, w_tensor, y_tensor);

                            float[] y_expect = y.ToFloatArray();
                            float[] y_actual = y_tensor;

                            CollectionAssert.AreEqual(xval, (float[])x_tensor);
                            CollectionAssert.AreEqual(wval, (float[])w_tensor);

                            AssertError.Tolerance(y_expect, y_actual, 1e-10f, 1e-5f, ref max_err, $"NG: {ic},{oc},{iw},{ih},{id},{kw},{kh},{kd},{n}");

                            Console.WriteLine($"OK: {ic},{oc},{iw},{ih},{id},{kw},{kh},{kd},{n}");
                        }
                    }
                }
            }

            Console.WriteLine($"maxerr:{max_err}");
        }

        public static Map3D Reference(Map3D x, Filter3D w, int kw, int kh, int kd) {
            int inchannels = x.Channels, outchannels = w.OutChannels, batch = x.Batch;
            int iw = x.Width, ow = iw - kw + 1, ih = x.Height, oh = ih - kh + 1, id = x.Depth, od = id - kd + 1;

            Map3D y = new(outchannels, ow, oh, od, batch);

            for (int th = 0; th < batch; th++) {
                for (int kz = 0; kz < kd; kz++) {
                    for (int ky = 0; ky < kh; ky++) {
                        for (int kx = 0; kx < kw; kx++) {
                            for (int oz = 0; oz < od; oz++) {
                                for (int oy = 0; oy < oh; oy++) {
                                    for (int ox = 0; ox < ow; ox++) {
                                        for (int outch = 0; outch < outchannels; outch++) {
                                            double sum = y[outch, ox, oy, oz, th];

                                            for (int inch = 0; inch < inchannels; inch++) {
                                                sum += x[inch, kx + ox, ky + oy, kz + oz, th] * w[inch, kx, ky, kz, outch];
                                            }

                                            y[outch, ox, oy, oz, th] = sum;
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }

            return y;
        }

        [TestMethod]
        public void ReferenceTest() {
            int inchannels = 4, outchannels = 6;
            int kwidth = 3, kheight = 5, kdepth = 7, inwidth = 10, inheight = 9, indepth = 8, batch = 2;

            float[] xval = (new float[batch * inwidth * inheight * indepth * inchannels]).Select((_, idx) => idx * 1e-3f).ToArray();
            float[] wval = (new float[kwidth * kheight * kdepth * outchannels * inchannels]).Select((_, idx) => idx * 1e-3f).Reverse().ToArray();

            Map3D x = new(inchannels, inwidth, inheight, indepth, batch, xval);
            Filter3D w = new(inchannels, kwidth, kheight, kdepth, outchannels, wval);

            Map3D y = Reference(x, w, kwidth, kheight, kdepth);

            float[] y_expect = {
                1.093827140e+03f, 8.882329400e+02f, 6.826387400e+02f, 4.770445400e+02f, 2.714503400e+02f, 6.585614000e+01f, 1.097707100e+03f, 8.914073000e+02f, 6.851075000e+02f, 4.788077000e+02f, 2.725079000e+02f, 6.620810000e+01f,
                1.101587060e+03f, 8.945816600e+02f, 6.875762600e+02f, 4.805708600e+02f, 2.735654600e+02f, 6.656006000e+01f, 1.105467020e+03f, 8.977560200e+02f, 6.900450200e+02f, 4.823340200e+02f, 2.746230200e+02f, 6.691202000e+01f,
                1.109346980e+03f, 9.009303800e+02f, 6.925137800e+02f, 4.840971800e+02f, 2.756805800e+02f, 6.726398000e+01f, 1.113226940e+03f, 9.041047400e+02f, 6.949825400e+02f, 4.858603400e+02f, 2.767381400e+02f, 6.761594000e+01f,
                1.117106900e+03f, 9.072791000e+02f, 6.974513000e+02f, 4.876235000e+02f, 2.777957000e+02f, 6.796790000e+01f, 1.120986860e+03f, 9.104534600e+02f, 6.999200600e+02f, 4.893866600e+02f, 2.788532600e+02f, 6.831986000e+01f,
                1.132626740e+03f, 9.199765400e+02f, 7.073263400e+02f, 4.946761400e+02f, 2.820259400e+02f, 6.937574000e+01f, 1.136506700e+03f, 9.231509000e+02f, 7.097951000e+02f, 4.964393000e+02f, 2.830835000e+02f, 6.972770000e+01f,
                1.140386660e+03f, 9.263252600e+02f, 7.122638600e+02f, 4.982024600e+02f, 2.841410600e+02f, 7.007966000e+01f, 1.144266620e+03f, 9.294996200e+02f, 7.147326200e+02f, 4.999656200e+02f, 2.851986200e+02f, 7.043162000e+01f,
                1.148146580e+03f, 9.326739800e+02f, 7.172013800e+02f, 5.017287800e+02f, 2.862561800e+02f, 7.078358000e+01f, 1.152026540e+03f, 9.358483400e+02f, 7.196701400e+02f, 5.034919400e+02f, 2.873137400e+02f, 7.113554000e+01f,
                1.155906500e+03f, 9.390227000e+02f, 7.221389000e+02f, 5.052551000e+02f, 2.883713000e+02f, 7.148750000e+01f, 1.159786460e+03f, 9.421970600e+02f, 7.246076600e+02f, 5.070182600e+02f, 2.894288600e+02f, 7.183946000e+01f,
                1.171426340e+03f, 9.517201400e+02f, 7.320139400e+02f, 5.123077400e+02f, 2.926015400e+02f, 7.289534000e+01f, 1.175306300e+03f, 9.548945000e+02f, 7.344827000e+02f, 5.140709000e+02f, 2.936591000e+02f, 7.324730000e+01f,
                1.179186260e+03f, 9.580688600e+02f, 7.369514600e+02f, 5.158340600e+02f, 2.947166600e+02f, 7.359926000e+01f, 1.183066220e+03f, 9.612432200e+02f, 7.394202200e+02f, 5.175972200e+02f, 2.957742200e+02f, 7.395122000e+01f,
                1.186946180e+03f, 9.644175800e+02f, 7.418889800e+02f, 5.193603800e+02f, 2.968317800e+02f, 7.430318000e+01f, 1.190826140e+03f, 9.675919400e+02f, 7.443577400e+02f, 5.211235400e+02f, 2.978893400e+02f, 7.465514000e+01f,
                1.194706100e+03f, 9.707663000e+02f, 7.468265000e+02f, 5.228867000e+02f, 2.989469000e+02f, 7.500710000e+01f, 1.198586060e+03f, 9.739406600e+02f, 7.492952600e+02f, 5.246498600e+02f, 3.000044600e+02f, 7.535906000e+01f,
                1.210225940e+03f, 9.834637400e+02f, 7.567015400e+02f, 5.299393400e+02f, 3.031771400e+02f, 7.641494000e+01f, 1.214105900e+03f, 9.866381000e+02f, 7.591703000e+02f, 5.317025000e+02f, 3.042347000e+02f, 7.676690000e+01f,
                1.217985860e+03f, 9.898124600e+02f, 7.616390600e+02f, 5.334656600e+02f, 3.052922600e+02f, 7.711886000e+01f, 1.221865820e+03f, 9.929868200e+02f, 7.641078200e+02f, 5.352288200e+02f, 3.063498200e+02f, 7.747082000e+01f,
                1.225745780e+03f, 9.961611800e+02f, 7.665765800e+02f, 5.369919800e+02f, 3.074073800e+02f, 7.782278000e+01f, 1.229625740e+03f, 9.993355400e+02f, 7.690453400e+02f, 5.387551400e+02f, 3.084649400e+02f, 7.817474000e+01f,
                1.233505700e+03f, 1.002509900e+03f, 7.715141000e+02f, 5.405183000e+02f, 3.095225000e+02f, 7.852670000e+01f, 1.237385660e+03f, 1.005684260e+03f, 7.739828600e+02f, 5.422814600e+02f, 3.105800600e+02f, 7.887866000e+01f,
                1.249025540e+03f, 1.015207340e+03f, 7.813891400e+02f, 5.475709400e+02f, 3.137527400e+02f, 7.993454000e+01f, 1.252905500e+03f, 1.018381700e+03f, 7.838579000e+02f, 5.493341000e+02f, 3.148103000e+02f, 8.028650000e+01f,
                1.256785460e+03f, 1.021556060e+03f, 7.863266600e+02f, 5.510972600e+02f, 3.158678600e+02f, 8.063846000e+01f, 1.260665420e+03f, 1.024730420e+03f, 7.887954200e+02f, 5.528604200e+02f, 3.169254200e+02f, 8.099042000e+01f,
                1.264545380e+03f, 1.027904780e+03f, 7.912641800e+02f, 5.546235800e+02f, 3.179829800e+02f, 8.134238000e+01f, 1.268425340e+03f, 1.031079140e+03f, 7.937329400e+02f, 5.563867400e+02f, 3.190405400e+02f, 8.169434000e+01f,
                1.272305300e+03f, 1.034253500e+03f, 7.962017000e+02f, 5.581499000e+02f, 3.200981000e+02f, 8.204630000e+01f, 1.276185260e+03f, 1.037427860e+03f, 7.986704600e+02f, 5.599130600e+02f, 3.211556600e+02f, 8.239826000e+01f,
                1.443023540e+03f, 1.173925340e+03f, 9.048271400e+02f, 6.357289400e+02f, 3.666307400e+02f, 9.753254000e+01f, 1.446903500e+03f, 1.177099700e+03f, 9.072959000e+02f, 6.374921000e+02f, 3.676883000e+02f, 9.788450000e+01f,
                1.450783460e+03f, 1.180274060e+03f, 9.097646600e+02f, 6.392552600e+02f, 3.687458600e+02f, 9.823646000e+01f, 1.454663420e+03f, 1.183448420e+03f, 9.122334200e+02f, 6.410184200e+02f, 3.698034200e+02f, 9.858842000e+01f,
                1.458543380e+03f, 1.186622780e+03f, 9.147021800e+02f, 6.427815800e+02f, 3.708609800e+02f, 9.894038000e+01f, 1.462423340e+03f, 1.189797140e+03f, 9.171709400e+02f, 6.445447400e+02f, 3.719185400e+02f, 9.929234000e+01f,
                1.466303300e+03f, 1.192971500e+03f, 9.196397000e+02f, 6.463079000e+02f, 3.729761000e+02f, 9.964430000e+01f, 1.470183260e+03f, 1.196145860e+03f, 9.221084600e+02f, 6.480710600e+02f, 3.740336600e+02f, 9.999626000e+01f,
                1.481823140e+03f, 1.205668940e+03f, 9.295147400e+02f, 6.533605400e+02f, 3.772063400e+02f, 1.010521400e+02f, 1.485703100e+03f, 1.208843300e+03f, 9.319835000e+02f, 6.551237000e+02f, 3.782639000e+02f, 1.014041000e+02f,
                1.489583060e+03f, 1.212017660e+03f, 9.344522600e+02f, 6.568868600e+02f, 3.793214600e+02f, 1.017560600e+02f, 1.493463020e+03f, 1.215192020e+03f, 9.369210200e+02f, 6.586500200e+02f, 3.803790200e+02f, 1.021080200e+02f,
                1.497342980e+03f, 1.218366380e+03f, 9.393897800e+02f, 6.604131800e+02f, 3.814365800e+02f, 1.024599800e+02f, 1.501222940e+03f, 1.221540740e+03f, 9.418585400e+02f, 6.621763400e+02f, 3.824941400e+02f, 1.028119400e+02f,
                1.505102900e+03f, 1.224715100e+03f, 9.443273000e+02f, 6.639395000e+02f, 3.835517000e+02f, 1.031639000e+02f, 1.508982860e+03f, 1.227889460e+03f, 9.467960600e+02f, 6.657026600e+02f, 3.846092600e+02f, 1.035158600e+02f,
                1.520622740e+03f, 1.237412540e+03f, 9.542023400e+02f, 6.709921400e+02f, 3.877819400e+02f, 1.045717400e+02f, 1.524502700e+03f, 1.240586900e+03f, 9.566711000e+02f, 6.727553000e+02f, 3.888395000e+02f, 1.049237000e+02f,
                1.528382660e+03f, 1.243761260e+03f, 9.591398600e+02f, 6.745184600e+02f, 3.898970600e+02f, 1.052756600e+02f, 1.532262620e+03f, 1.246935620e+03f, 9.616086200e+02f, 6.762816200e+02f, 3.909546200e+02f, 1.056276200e+02f,
                1.536142580e+03f, 1.250109980e+03f, 9.640773800e+02f, 6.780447800e+02f, 3.920121800e+02f, 1.059795800e+02f, 1.540022540e+03f, 1.253284340e+03f, 9.665461400e+02f, 6.798079400e+02f, 3.930697400e+02f, 1.063315400e+02f,
                1.543902500e+03f, 1.256458700e+03f, 9.690149000e+02f, 6.815711000e+02f, 3.941273000e+02f, 1.066835000e+02f, 1.547782460e+03f, 1.259633060e+03f, 9.714836600e+02f, 6.833342600e+02f, 3.951848600e+02f, 1.070354600e+02f,
                1.559422340e+03f, 1.269156140e+03f, 9.788899400e+02f, 6.886237400e+02f, 3.983575400e+02f, 1.080913400e+02f, 1.563302300e+03f, 1.272330500e+03f, 9.813587000e+02f, 6.903869000e+02f, 3.994151000e+02f, 1.084433000e+02f,
                1.567182260e+03f, 1.275504860e+03f, 9.838274600e+02f, 6.921500600e+02f, 4.004726600e+02f, 1.087952600e+02f, 1.571062220e+03f, 1.278679220e+03f, 9.862962200e+02f, 6.939132200e+02f, 4.015302200e+02f, 1.091472200e+02f,
                1.574942180e+03f, 1.281853580e+03f, 9.887649800e+02f, 6.956763800e+02f, 4.025877800e+02f, 1.094991800e+02f, 1.578822140e+03f, 1.285027940e+03f, 9.912337400e+02f, 6.974395400e+02f, 4.036453400e+02f, 1.098511400e+02f,
                1.582702100e+03f, 1.288202300e+03f, 9.937025000e+02f, 6.992027000e+02f, 4.047029000e+02f, 1.102031000e+02f, 1.586582060e+03f, 1.291376660e+03f, 9.961712600e+02f, 7.009658600e+02f, 4.057604600e+02f, 1.105550600e+02f,
                1.598221940e+03f, 1.300899740e+03f, 1.003577540e+03f, 7.062553400e+02f, 4.089331400e+02f, 1.116109400e+02f, 1.602101900e+03f, 1.304074100e+03f, 1.006046300e+03f, 7.080185000e+02f, 4.099907000e+02f, 1.119629000e+02f,
                1.605981860e+03f, 1.307248460e+03f, 1.008515060e+03f, 7.097816600e+02f, 4.110482600e+02f, 1.123148600e+02f, 1.609861820e+03f, 1.310422820e+03f, 1.010983820e+03f, 7.115448200e+02f, 4.121058200e+02f, 1.126668200e+02f,
                1.613741780e+03f, 1.313597180e+03f, 1.013452580e+03f, 7.133079800e+02f, 4.131633800e+02f, 1.130187800e+02f, 1.617621740e+03f, 1.316771540e+03f, 1.015921340e+03f, 7.150711400e+02f, 4.142209400e+02f, 1.133707400e+02f,
                1.621501700e+03f, 1.319945900e+03f, 1.018390100e+03f, 7.168343000e+02f, 4.152785000e+02f, 1.137227000e+02f, 1.625381660e+03f, 1.323120260e+03f, 1.020858860e+03f, 7.185974600e+02f, 4.163360600e+02f, 1.140746600e+02f,
                3.887398340e+03f, 3.173772140e+03f, 2.460145940e+03f, 1.746519740e+03f, 1.032893540e+03f, 3.192673400e+02f, 3.891278300e+03f, 3.176946500e+03f, 2.462614700e+03f, 1.748282900e+03f, 1.033951100e+03f, 3.196193000e+02f,
                3.895158260e+03f, 3.180120860e+03f, 2.465083460e+03f, 1.750046060e+03f, 1.035008660e+03f, 3.199712600e+02f, 3.899038220e+03f, 3.183295220e+03f, 2.467552220e+03f, 1.751809220e+03f, 1.036066220e+03f, 3.203232200e+02f,
                3.902918180e+03f, 3.186469580e+03f, 2.470020980e+03f, 1.753572380e+03f, 1.037123780e+03f, 3.206751800e+02f, 3.906798140e+03f, 3.189643940e+03f, 2.472489740e+03f, 1.755335540e+03f, 1.038181340e+03f, 3.210271400e+02f,
                3.910678100e+03f, 3.192818300e+03f, 2.474958500e+03f, 1.757098700e+03f, 1.039238900e+03f, 3.213791000e+02f, 3.914558060e+03f, 3.195992660e+03f, 2.477427260e+03f, 1.758861860e+03f, 1.040296460e+03f, 3.217310600e+02f,
                3.926197940e+03f, 3.205515740e+03f, 2.484833540e+03f, 1.764151340e+03f, 1.043469140e+03f, 3.227869400e+02f, 3.930077900e+03f, 3.208690100e+03f, 2.487302300e+03f, 1.765914500e+03f, 1.044526700e+03f, 3.231389000e+02f,
                3.933957860e+03f, 3.211864460e+03f, 2.489771060e+03f, 1.767677660e+03f, 1.045584260e+03f, 3.234908600e+02f, 3.937837820e+03f, 3.215038820e+03f, 2.492239820e+03f, 1.769440820e+03f, 1.046641820e+03f, 3.238428200e+02f,
                3.941717780e+03f, 3.218213180e+03f, 2.494708580e+03f, 1.771203980e+03f, 1.047699380e+03f, 3.241947800e+02f, 3.945597740e+03f, 3.221387540e+03f, 2.497177340e+03f, 1.772967140e+03f, 1.048756940e+03f, 3.245467400e+02f,
                3.949477700e+03f, 3.224561900e+03f, 2.499646100e+03f, 1.774730300e+03f, 1.049814500e+03f, 3.248987000e+02f, 3.953357660e+03f, 3.227736260e+03f, 2.502114860e+03f, 1.776493460e+03f, 1.050872060e+03f, 3.252506600e+02f,
                3.964997540e+03f, 3.237259340e+03f, 2.509521140e+03f, 1.781782940e+03f, 1.054044740e+03f, 3.263065400e+02f, 3.968877500e+03f, 3.240433700e+03f, 2.511989900e+03f, 1.783546100e+03f, 1.055102300e+03f, 3.266585000e+02f,
                3.972757460e+03f, 3.243608060e+03f, 2.514458660e+03f, 1.785309260e+03f, 1.056159860e+03f, 3.270104600e+02f, 3.976637420e+03f, 3.246782420e+03f, 2.516927420e+03f, 1.787072420e+03f, 1.057217420e+03f, 3.273624200e+02f,
                3.980517380e+03f, 3.249956780e+03f, 2.519396180e+03f, 1.788835580e+03f, 1.058274980e+03f, 3.277143800e+02f, 3.984397340e+03f, 3.253131140e+03f, 2.521864940e+03f, 1.790598740e+03f, 1.059332540e+03f, 3.280663400e+02f,
                3.988277300e+03f, 3.256305500e+03f, 2.524333700e+03f, 1.792361900e+03f, 1.060390100e+03f, 3.284183000e+02f, 3.992157260e+03f, 3.259479860e+03f, 2.526802460e+03f, 1.794125060e+03f, 1.061447660e+03f, 3.287702600e+02f,
                4.003797140e+03f, 3.269002940e+03f, 2.534208740e+03f, 1.799414540e+03f, 1.064620340e+03f, 3.298261400e+02f, 4.007677100e+03f, 3.272177300e+03f, 2.536677500e+03f, 1.801177700e+03f, 1.065677900e+03f, 3.301781000e+02f,
                4.011557060e+03f, 3.275351660e+03f, 2.539146260e+03f, 1.802940860e+03f, 1.066735460e+03f, 3.305300600e+02f, 4.015437020e+03f, 3.278526020e+03f, 2.541615020e+03f, 1.804704020e+03f, 1.067793020e+03f, 3.308820200e+02f,
                4.019316980e+03f, 3.281700380e+03f, 2.544083780e+03f, 1.806467180e+03f, 1.068850580e+03f, 3.312339800e+02f, 4.023196940e+03f, 3.284874740e+03f, 2.546552540e+03f, 1.808230340e+03f, 1.069908140e+03f, 3.315859400e+02f,
                4.027076900e+03f, 3.288049100e+03f, 2.549021300e+03f, 1.809993500e+03f, 1.070965700e+03f, 3.319379000e+02f, 4.030956860e+03f, 3.291223460e+03f, 2.551490060e+03f, 1.811756660e+03f, 1.072023260e+03f, 3.322898600e+02f,
                4.042596740e+03f, 3.300746540e+03f, 2.558896340e+03f, 1.817046140e+03f, 1.075195940e+03f, 3.333457400e+02f, 4.046476700e+03f, 3.303920900e+03f, 2.561365100e+03f, 1.818809300e+03f, 1.076253500e+03f, 3.336977000e+02f,
                4.050356660e+03f, 3.307095260e+03f, 2.563833860e+03f, 1.820572460e+03f, 1.077311060e+03f, 3.340496600e+02f, 4.054236620e+03f, 3.310269620e+03f, 2.566302620e+03f, 1.822335620e+03f, 1.078368620e+03f, 3.344016200e+02f,
                4.058116580e+03f, 3.313443980e+03f, 2.568771380e+03f, 1.824098780e+03f, 1.079426180e+03f, 3.347535800e+02f, 4.061996540e+03f, 3.316618340e+03f, 2.571240140e+03f, 1.825861940e+03f, 1.080483740e+03f, 3.351055400e+02f,
                4.065876500e+03f, 3.319792700e+03f, 2.573708900e+03f, 1.827625100e+03f, 1.081541300e+03f, 3.354575000e+02f, 4.069756460e+03f, 3.322967060e+03f, 2.576177660e+03f, 1.829388260e+03f, 1.082598860e+03f, 3.358094600e+02f,
                4.236594740e+03f, 3.459464540e+03f, 2.682334340e+03f, 1.905204140e+03f, 1.128073940e+03f, 3.509437400e+02f, 4.240474700e+03f, 3.462638900e+03f, 2.684803100e+03f, 1.906967300e+03f, 1.129131500e+03f, 3.512957000e+02f,
                4.244354660e+03f, 3.465813260e+03f, 2.687271860e+03f, 1.908730460e+03f, 1.130189060e+03f, 3.516476600e+02f, 4.248234620e+03f, 3.468987620e+03f, 2.689740620e+03f, 1.910493620e+03f, 1.131246620e+03f, 3.519996200e+02f,
                4.252114580e+03f, 3.472161980e+03f, 2.692209380e+03f, 1.912256780e+03f, 1.132304180e+03f, 3.523515800e+02f, 4.255994540e+03f, 3.475336340e+03f, 2.694678140e+03f, 1.914019940e+03f, 1.133361740e+03f, 3.527035400e+02f,
                4.259874500e+03f, 3.478510700e+03f, 2.697146900e+03f, 1.915783100e+03f, 1.134419300e+03f, 3.530555000e+02f, 4.263754460e+03f, 3.481685060e+03f, 2.699615660e+03f, 1.917546260e+03f, 1.135476860e+03f, 3.534074600e+02f,
                4.275394340e+03f, 3.491208140e+03f, 2.707021940e+03f, 1.922835740e+03f, 1.138649540e+03f, 3.544633400e+02f, 4.279274300e+03f, 3.494382500e+03f, 2.709490700e+03f, 1.924598900e+03f, 1.139707100e+03f, 3.548153000e+02f,
                4.283154260e+03f, 3.497556860e+03f, 2.711959460e+03f, 1.926362060e+03f, 1.140764660e+03f, 3.551672600e+02f, 4.287034220e+03f, 3.500731220e+03f, 2.714428220e+03f, 1.928125220e+03f, 1.141822220e+03f, 3.555192200e+02f,
                4.290914180e+03f, 3.503905580e+03f, 2.716896980e+03f, 1.929888380e+03f, 1.142879780e+03f, 3.558711800e+02f, 4.294794140e+03f, 3.507079940e+03f, 2.719365740e+03f, 1.931651540e+03f, 1.143937340e+03f, 3.562231400e+02f,
                4.298674100e+03f, 3.510254300e+03f, 2.721834500e+03f, 1.933414700e+03f, 1.144994900e+03f, 3.565751000e+02f, 4.302554060e+03f, 3.513428660e+03f, 2.724303260e+03f, 1.935177860e+03f, 1.146052460e+03f, 3.569270600e+02f,
                4.314193940e+03f, 3.522951740e+03f, 2.731709540e+03f, 1.940467340e+03f, 1.149225140e+03f, 3.579829400e+02f, 4.318073900e+03f, 3.526126100e+03f, 2.734178300e+03f, 1.942230500e+03f, 1.150282700e+03f, 3.583349000e+02f,
                4.321953860e+03f, 3.529300460e+03f, 2.736647060e+03f, 1.943993660e+03f, 1.151340260e+03f, 3.586868600e+02f, 4.325833820e+03f, 3.532474820e+03f, 2.739115820e+03f, 1.945756820e+03f, 1.152397820e+03f, 3.590388200e+02f,
                4.329713780e+03f, 3.535649180e+03f, 2.741584580e+03f, 1.947519980e+03f, 1.153455380e+03f, 3.593907800e+02f, 4.333593740e+03f, 3.538823540e+03f, 2.744053340e+03f, 1.949283140e+03f, 1.154512940e+03f, 3.597427400e+02f,
                4.337473700e+03f, 3.541997900e+03f, 2.746522100e+03f, 1.951046300e+03f, 1.155570500e+03f, 3.600947000e+02f, 4.341353660e+03f, 3.545172260e+03f, 2.748990860e+03f, 1.952809460e+03f, 1.156628060e+03f, 3.604466600e+02f,
                4.352993540e+03f, 3.554695340e+03f, 2.756397140e+03f, 1.958098940e+03f, 1.159800740e+03f, 3.615025400e+02f, 4.356873500e+03f, 3.557869700e+03f, 2.758865900e+03f, 1.959862100e+03f, 1.160858300e+03f, 3.618545000e+02f,
                4.360753460e+03f, 3.561044060e+03f, 2.761334660e+03f, 1.961625260e+03f, 1.161915860e+03f, 3.622064600e+02f, 4.364633420e+03f, 3.564218420e+03f, 2.763803420e+03f, 1.963388420e+03f, 1.162973420e+03f, 3.625584200e+02f,
                4.368513380e+03f, 3.567392780e+03f, 2.766272180e+03f, 1.965151580e+03f, 1.164030980e+03f, 3.629103800e+02f, 4.372393340e+03f, 3.570567140e+03f, 2.768740940e+03f, 1.966914740e+03f, 1.165088540e+03f, 3.632623400e+02f,
                4.376273300e+03f, 3.573741500e+03f, 2.771209700e+03f, 1.968677900e+03f, 1.166146100e+03f, 3.636143000e+02f, 4.380153260e+03f, 3.576915860e+03f, 2.773678460e+03f, 1.970441060e+03f, 1.167203660e+03f, 3.639662600e+02f,
                4.391793140e+03f, 3.586438940e+03f, 2.781084740e+03f, 1.975730540e+03f, 1.170376340e+03f, 3.650221400e+02f, 4.395673100e+03f, 3.589613300e+03f, 2.783553500e+03f, 1.977493700e+03f, 1.171433900e+03f, 3.653741000e+02f,
                4.399553060e+03f, 3.592787660e+03f, 2.786022260e+03f, 1.979256860e+03f, 1.172491460e+03f, 3.657260600e+02f, 4.403433020e+03f, 3.595962020e+03f, 2.788491020e+03f, 1.981020020e+03f, 1.173549020e+03f, 3.660780200e+02f,
                4.407312980e+03f, 3.599136380e+03f, 2.790959780e+03f, 1.982783180e+03f, 1.174606580e+03f, 3.664299800e+02f, 4.411192940e+03f, 3.602310740e+03f, 2.793428540e+03f, 1.984546340e+03f, 1.175664140e+03f, 3.667819400e+02f,
                4.415072900e+03f, 3.605485100e+03f, 2.795897300e+03f, 1.986309500e+03f, 1.176721700e+03f, 3.671339000e+02f, 4.418952860e+03f, 3.608659460e+03f, 2.798366060e+03f, 1.988072660e+03f, 1.177779260e+03f, 3.674858600e+02f,
            };

            float[] y_actual = y.ToFloatArray();

            AssertError.Tolerance(y_expect, y_actual, 1e-10f, 1e-5f);
        }
    }
}
